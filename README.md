# 五度圏Webアプリ

**作成日**: 2025年11月13日
**作成者**: 蔵人
**目的**: HPSメンバーの学習支援、音楽理論の視覚化

---

## 使い方

### ローカルで開く
1. Finderで以下のファイルをダブルクリック:
   `/Users/nozakidaikai/Obsidian/デジタル百姓総本部/プロジェクト/五度圏アプリ/index.html`
2. ブラウザで開きます

### 操作方法
- **外側の円**: 長調（C, G, D, A, E, B, G♭, D♭, A♭, E♭, B♭, F）
- **内側の円**: 短調（Am, Em, Bm, F#m, C#m, G#m, E♭m, B♭m, Fm, Cm, Gm, Dm）
- **キー選択**: キーを選択すると、調号、平行調、ダイアトニックコードのディグリーが表示されます
  - 長調選択時：メジャーダイアトニック（I, ii, iii, IV, V, vi, vii°）
  - 短調選択時：ナチュラルマイナーダイアトニック（i, ii°, ♭III, iv, v, ♭VI, ♭VII）
  - メジャーコードは外側、マイナーコード/ディミニッシュは内側に表示
- **コード進行**: 右側のドロップダウンから1625, 4536などのよくあるコード進行を選択できます
  - 選択したキーに合わせて、ディグリー、機能（トニック/サブドミナント/ドミナント）、コード名、ルート音が表示されます
  - ♯系キーでは♯表記、♭系キーでは♭表記で統一されます

---

## 現在の機能

- ✅ 五度圏の円形表示（外側：長調、内側：短調）
- ✅ キーをクリックして選択
- ✅ 調号の情報表示（♯の数、♭の数）
- ✅ 平行調の表示
- ✅ ダイアトニックコード表示（ディグリー）
  - 長調：I, ii, iii, IV, V, vi, vii°
  - 短調：i, ii°, bIII, iv, v, bVI, bVII
  - メジャーコードは外側（大）、マイナーコードは内側（小）に表示
- ✅ コード進行表示機能（v0.3）
  - 1625, 4536, 1456, 1564, 1645のよくあるコード進行
  - ディグリー、機能（T/SD/D）、コード名、ルート音を表示
  - 選択キーに合わせて異名同音を自動調整（♯系/♭系）

---

## 次のバージョンで追加予定

- [ ] 四和音表記（メジャーセブンス、マイナーセブンスなど）を表示
- [ ] 64パッドとの対応表示
- [ ] 音声再生機能
- [ ] ハーモニックマイナー・メロディックマイナーの表示
- [ ] より多くのコード進行パターン追加

---

## 技術仕様

- **言語**: HTML, CSS, JavaScript
- **グラフィック**: SVG
- **外部ライブラリ**: なし（Pure JavaScript）

---

## 開発フロー（重要）

### 基本ルール
**動作確認してから公開する！**

### 手順

1. **機能を追加・修正する**
   - `index.html` を編集

2. **gitにコミット（バージョン保存）**
   ```bash
   cd "/Users/nozakidaikai/Obsidian/デジタル百姓総本部/プロジェクト/五度圏アプリ"
   git add .
   git commit -m "v0.x: 機能追加の説明"
   ```

3. **ローカルで動作確認**
   - Finderで `index.html` をダブルクリック
   - ブラウザで動作を確認
   - **問題があれば修正 → gitコミット → 再確認**

4. **動作OKなら本番公開（Netlify）**
   ```bash
   netlify deploy --prod --message "v0.x: 機能追加の説明"
   ```

5. **公開URLで確認**
   - https://delightful-pie-ee8f76.netlify.app
   - 問題なければ完了！

### 巻き戻し方法

もし問題があったら、gitで前のバージョンに戻せます：

```bash
# コミット履歴を確認
git log --oneline

# 特定のバージョンに戻す
git checkout <コミットID>

# 再度公開
netlify deploy --prod
```

---

## 公開URL

**本番**: https://delightful-pie-ee8f76.netlify.app

---

## 更新履歴

### v0.6.1 (2025-11-14)
- **UI改善 - スクロールなしで全表示可能に**
  - ダイアトニックコード一覧表を右パネルに移動
  - 情報パネルから「ダイアトニックコード: 五度圏上に表示されています」メッセージを削除
  - 全体のレイアウトをコンパクト化
    - フォントサイズを調整（0.9em）
    - パディング・マージンを削減
    - テーブルの行高を圧縮
  - キー選択 + コード進行表示でもスクロール不要

### v0.6 (2025-11-14)
- **ダイアトニックコード一覧表を追加**
  - 五度圏の下にダイアトニックコード一覧表を表示
  - ディグリー、コード名、機能が表形式で確認可能
  - 機能別の色分け表示（トニック/サブドミナント/ドミナント）
  - マイナーキー選択時はナチュラルマイナー（vm7）とハーモニックマイナー（V7）の両方を併記
  - メジャーキー：7つのダイアトニックコード表示
  - マイナーキー：8つのダイアトニックコード表示（vm7とV7含む）

### v0.5 (2025-11-14)
- **マイナー系コード進行10選を追加**（ジャズ/ブルース向け）
  - マイナー・ツーファイブワン (IIm7♭5-V7-Im)
  - マイナー・ブルース (Im-IVm-V7-Im)
  - マイナー・ライン・クリシェ (Im-Im(Maj7)-Im7-Im6)
  - セカンダリー・ドミナント (Im-I7-IVm-V7)
  - ハーモニック・マイナー進行 (Im-bVI-V7-Im)
  - リラティブ・メジャーへ (IIm7♭5-V7-Im-bIII)
  - ディミニッシュ・アプローチ (Im-VIIdim-V7-Im)
  - ナチュラルマイナー系 (Im-IVm-bVII-bIII)
  - ツーファイブへの準備 (Im-bVI-IIm7♭5-V7)
  - 王道進行マイナー版 (bVI-bVII-Im-V7)
- **機能別色分け実装**
  - トニック系：オレンジ (#ff9800)
  - サブドミナント系：ブルー (#42a5f5)
  - ドミナント系：レッド (#ef5350)
  - 代理コードも同じ機能で同じ色表示（学習支援）
- **動的ドロップダウン実装**
  - メジャーキー選択時：メジャー系進行10選を表示
  - マイナーキー選択時：マイナー系進行10選を表示
  - キータイプ切り替え時に進行表示をリセット
- **マイナーキーのオフセット計算を修正**
  - デュアルオフセットシステム導入（`offset`と`circleOffset`）
  - `offset`: コード進行の実際の根音計算用（マイナートニック基準）
  - `circleOffset`: 五度圏上の表示位置用（平行長調基準）
  - bVI, VII, bVII, bIIIなどのオフセット値を正確に調整
- **UI改善**
  - 五度圏上はダイアトニックコードのみ表示（ノンダイアトニックを除外）
  - メジャーキー選択時にIVm7が表示されないように修正
  - ディグリー表記の重複を修正（roman + suffix構造の分離）
  - ii°の°記号を削除して統一（iim7(♭5)）

### v0.4 (2025-11-14)
- メジャー系コード進行10選に変更
  - ツーファイブワン (II-V-I)
  - 50s進行 (I-VI-IV-V)
  - 王道進行 (I-V-VI-IV)
  - 王道進行バリエ (IV-V-I-VI)
  - サブドミナント・マイナー進行 (IV-IVm-I-I7)
  - スリーコード (I-IV-V-I)
  - 1625進行 (I-VI-II-V)
  - IV-V-III-VI, I-III-IV-V, I-bVII-IV-I
- ノンダイアトニックコード対応（IVm7, I7, bVII）
- 五度圏上は基本ダイアトニックのみ表示、コード進行パネルではノンダイアトニックも使用可能

### v0.3 (2025-11-14)
- コード進行表示機能を追加（1625, 4536, 1456, 1564, 1645）
- 2カラムレイアウト実装（左：五度圏、右：コード進行パネル）
- ディグリー、機能（T/SD/D）、コード名、ルート音を表で表示
- 異名同音対応（♯系キーは♯表記、♭系キーは♭表記で統一）
- G♭表記に統一（F♯ではなくG♭を採用）

### v0.2 (2025-11-13)
- ダイアトニックコード表示機能を追加
- 長調：メジャーダイアトニック（I, ii, iii, IV, V, vi, vii°）
- 短調：ナチュラルマイナーダイアトニック（i, ii°, bIII, iv, v, bVI, bVII）
- メジャーコードは外側に大きく、マイナーコードは内側に小さく表示
- 短調キー名と重ならないように位置調整

### v0.1 (2025-11-13)
- 基本的な五度圏表示を実装
- キー選択機能
- 調号情報表示

---

## デザイン要望

![[5度圏.png]]
![[改善.png]]